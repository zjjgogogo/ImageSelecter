package com.test.imagedemo;import android.content.Context;import android.util.AttributeSet;import android.view.View;import android.widget.BaseAdapter;import android.widget.HorizontalScrollView;import android.widget.ImageView;import android.widget.LinearLayout;import com.nineoldandroids.animation.Animator.AnimatorListener;import com.nineoldandroids.view.ViewPropertyAnimator;public class PicsShowView extends HorizontalScrollView {	LinearLayout mContainer;	int maxPicNum = 6;	OnClickListener mDeleteClickListener;	OnClickListener mAddClickListener;	OnClickListener mItemClickListener;	AnimatorListener mAnimatorListener;	boolean isMoveing = false;	public void setDeleteClickListener(OnClickListener mDeleteClickListener) {		this.mDeleteClickListener = mDeleteClickListener;	}	public void setAddClickListener(OnClickListener mAddClickListener) {		this.mAddClickListener = mAddClickListener;	}	public void setItemClickListener(OnClickListener mItemClickListener) {		this.mItemClickListener = mItemClickListener;	}	public void setAnimatorListener(AnimatorListener mAnimatorListener) {		this.mAnimatorListener = mAnimatorListener;	}	public PicsShowView(Context context, AttributeSet attrs) {		super(context, attrs);		init();	}	public PicsShowView(Context context) {		this(context, null);	}	protected void init() {		mContainer = new LinearLayout(getContext());		addView(mContainer);	}	public void setMaxPicNum(int num) {		this.maxPicNum = num;	}	public void setAdapter(BaseAdapter mBaseAdapter) {		mContainer.removeAllViews();		final int count = mBaseAdapter.getCount();		for (int i = 0; i < count; i++) {			View view = mBaseAdapter.getView(i, null, null);			view.findViewById(R.id.btn_delete).setTag(i);			view.findViewById(R.id.btn_delete).setOnClickListener(					mDeleteClickListener);			view.setTag(i);			view.setOnClickListener(mItemClickListener);			mContainer.addView(view, generateLayoutParams());		}		if (mContainer.getChildCount() < maxPicNum) {			ImageView mImageView = new ImageView(getContext());			mImageView.setImageResource(R.drawable.add_pic_btn);			mImageView.setOnClickListener(mAddClickListener);			mContainer.addView(mImageView, generateLayoutParams());		}	}	public void removeItem(int position) {		final int count = mContainer.getChildCount();		int itemPadding = getResources().getDimensionPixelSize(				R.dimen.pic_item_padding) * 2;		View view = mContainer.getChildAt(position);		ViewPropertyAnimator.animate(view).translationYBy(view.getHeight())				.setDuration(200);		for (int i = position + 1; i < count; i++) {			View mView = mContainer.getChildAt(i);			ViewPropertyAnimator.animate(mView).setDuration(250)					.translationXBy(-view.getWidth() - itemPadding)					.setListener(mAnimatorListener);		}	}	public void removeView(int position) {		View view = mContainer.getChildAt(position);		mContainer.removeView(view);		mContainer.requestLayout();		updateChildsTag();	}	protected void updateChildsTag() {		final int count = mContainer.getChildCount();		for (int i = 0; i < count; i++) {			View view = mContainer.getChildAt(i);			view.setTag(i);			View delelete = view.findViewById(R.id.btn_delete);			if (delelete != null) {				delelete.setTag(i);			}		}	}	protected android.widget.LinearLayout.LayoutParams generateLayoutParams() {		int itemWidth = getResources().getDimensionPixelSize(				R.dimen.pic_item_width);		int itemHeight = getResources().getDimensionPixelSize(				R.dimen.pic_item_height);		int itemPadding = getResources().getDimensionPixelSize(				R.dimen.pic_item_padding);		android.widget.LinearLayout.LayoutParams mLayoutParams = new android.widget.LinearLayout.LayoutParams(				itemWidth, itemHeight, 1);		mLayoutParams.leftMargin = itemPadding;		mLayoutParams.rightMargin = itemPadding;		return mLayoutParams;	}}